name: g1.posts.api

build:
  posts-api:
    context: .

deploy:
   - helm upgrade --install posts-ms chart
     --set api.image=${OKTETO_BUILD_API_IMAGE}

dev:
  posts-api:
    command: ddtrace-run uvicorn src.main:app --host 0.0.0.0 --port 3001 
    forward:
      - 3000:3000
      - 8126:datadog-agent:8126
    sync:
      - .:/usr/snapmsg-posts

  datadog-agent:
    forward:
      - 8126:8126

